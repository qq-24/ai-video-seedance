{
  "project": "Spring FES Video",
  "description": "Story to Video Generation Platform",
  "tasks": [
    {
      "id": 1,
      "title": "Project Base Configuration",
      "description": "Configure basic project settings and dependencies",
      "steps": [
        "Install Supabase client: @supabase/supabase-js, @supabase/ssr",
        "Install UI component library: clsx, tailwind-merge",
        "Create .env.local template file (including all required environment variables)",
        "Create lib/utils.ts utility functions file"
      ],
      "passes": true
    },
    {
      "id": 2,
      "title": "Supabase Database Schema",
      "description": "Create database table structure (with confirmation status fields)",
      "steps": [
        "Create projects table (id, user_id, title, story, style, stage, created_at, updated_at)",
        "stage field: draft/scenes/images/videos/completed",
        "Create scenes table with confirmation status fields",
        "scenes: (id, project_id, order_index, description, description_confirmed, image_status, image_confirmed, video_status, video_confirmed, created_at)",
        "Create images table (id, scene_id, storage_path, url, width, height, version, created_at)",
        "Create videos table (id, scene_id, storage_path, url, duration, task_id, version, created_at)",
        "Set up foreign key relationships and indexes",
        "Create Storage bucket: project-media",
        "Write SQL migration file to supabase/migrations/"
      ],
      "passes": true
    },
    {
      "id": 3,
      "title": "Supabase Client Wrapper",
      "description": "Create server-side and client-side Supabase clients",
      "steps": [
        "Create lib/supabase/server.ts (server-side client)",
        "Create lib/supabase/client.ts (browser client)",
        "Create lib/supabase/middleware.ts (middleware)",
        "Update middleware.ts to integrate Supabase middleware"
      ],
      "passes": true
    },
    {
      "id": 4,
      "title": "User Authentication - Login Page",
      "description": "Implement user login functionality",
      "steps": [
        "Create app/login/page.tsx login page",
        "Create components/auth/LoginForm.tsx login form component",
        "Implement email + password login",
        "Redirect to home page after successful login",
        "Display login error messages"
      ],
      "passes": true
    },
    {
      "id": 5,
      "title": "User Authentication - Registration Page",
      "description": "Implement user registration functionality",
      "steps": [
        "Create app/register/page.tsx registration page",
        "Create components/auth/RegisterForm.tsx registration form component",
        "Implement email + password registration",
        "Redirect to login page after successful registration",
        "Display registration error messages"
      ],
      "passes": true
    },
    {
      "id": 6,
      "title": "User Authentication - Logout",
      "description": "Implement user logout functionality",
      "steps": [
        "Create components/auth/LogoutButton.tsx logout button component",
        "Implement logout logic",
        "Redirect to login page after logout"
      ],
      "passes": true
    },
    {
      "id": 7,
      "title": "Authentication Protection Middleware",
      "description": "Protect pages that require login",
      "steps": [
        "Configure middleware to protect routes: /projects, /create",
        "Redirect unauthenticated users to /login when accessing protected pages",
        "Redirect authenticated users to home page when accessing /login and /register"
      ],
      "passes": true
    },
    {
      "id": 8,
      "title": "Zhipu AI API Wrapper",
      "description": "Wrap Zhipu AI GLM model API calls",
      "steps": [
        "Create lib/ai/zhipu.ts",
        "Implement chat completions API call",
        "Implement error handling and retry logic",
        "Write story-to-scenes prompt template",
        "Create types/ai.ts for type definitions"
      ],
      "passes": true
    },
    {
      "id": 9,
      "title": "Volcano Engine Image Generation API Wrapper",
      "description": "Wrap Volcano Engine Seedream image generation",
      "steps": [
        "Create lib/ai/volc-image.ts",
        "Implement image generation API call",
        "Implement error handling and retry logic",
        "Add type definitions"
      ],
      "passes": true
    },
    {
      "id": 10,
      "title": "Volcano Engine Video Generation API Wrapper",
      "description": "Wrap Volcano Engine Seedance video generation",
      "steps": [
        "Create lib/ai/volc-video.ts",
        "Implement video task creation API",
        "Implement video task status query API",
        "Implement error handling and retry logic",
        "Add type definitions"
      ],
      "passes": true
    },
    {
      "id": 11,
      "title": "Project Data Access Layer",
      "description": "Create project CRUD operations",
      "steps": [
        "Create lib/db/projects.ts",
        "Implement createProject() to create a project",
        "Implement getProjects() to get user project list",
        "Implement getProjectById() to get a single project (including scenes and media)",
        "Implement updateProject() to update a project",
        "Implement updateProjectStage() to update project stage",
        "Implement deleteProject() to delete a project"
      ],
      "passes": true
    },
    {
      "id": 12,
      "title": "Scene Data Access Layer",
      "description": "Create scene CRUD and confirmation operations",
      "steps": [
        "Create lib/db/scenes.ts",
        "Implement createScenes() for batch scene creation",
        "Implement getScenesByProjectId() to get project scenes list",
        "Implement updateSceneDescription() to update scene description",
        "Implement confirmSceneDescription() to confirm scene description",
        "Implement confirmAllDescriptions() to confirm all scene descriptions",
        "Implement confirmSceneImage() to confirm scene image",
        "Implement confirmAllImages() to confirm all scene images",
        "Implement confirmSceneVideo() to confirm scene video",
        "Implement confirmAllVideos() to confirm all scene videos",
        "Implement deleteScenesByProjectId() to delete all scenes for a project (used when regenerating)"
      ],
      "passes": true
    },
    {
      "id": 13,
      "title": "Media Data Access Layer",
      "description": "Create image and video data access",
      "steps": [
        "Create lib/db/media.ts",
        "Implement createImage() to save image record (version auto-increments)",
        "Implement createVideo() to save video record",
        "Implement getMediaBySceneId() to get scene media",
        "Implement Supabase Storage upload functionality",
        "Implement Supabase Storage delete functionality (clean up old files when regenerating)"
      ],
      "passes": true
    },
    {
      "id": 14,
      "title": "Project API - CRUD",
      "description": "Implement project CRUD API endpoints",
      "steps": [
        "Create app/api/projects/route.ts",
        "POST /api/projects to create a project",
        "GET /api/projects to get project list (with pagination support)",
        "Create app/api/projects/[id]/route.ts",
        "GET /api/projects/:id to get project details (including all scenes and media)",
        "PATCH /api/projects/:id to update project (title, story, style)",
        "DELETE /api/projects/:id to delete project",
        "Verify user is the project owner"
      ],
      "passes": true
    },
    {
      "id": 15,
      "title": "Generation API - Scene Description Generation",
      "description": "Implement scene description generation and regeneration",
      "steps": [
        "Create app/api/generate/scenes/route.ts",
        "POST /api/generate/scenes to generate scene descriptions",
        "Call Zhipu AI GLM to break down the story",
        "Parse the returned JSON scene list",
        "Delete old scenes (if they exist)",
        "Save new scenes to database",
        "Update project stage to 'scenes'",
        "Return scene list",
        "Create app/api/generate/scenes/regenerate/route.ts",
        "POST to regenerate scenes (same flow as above)"
      ],
      "passes": true
    },
    {
      "id": 16,
      "title": "Generation API - Image Generation",
      "description": "Implement image generation and regeneration",
      "steps": [
        "Create app/api/generate/image/[sceneId]/route.ts",
        "POST /api/generate/image/:sceneId to generate image for a single scene",
        "Call Volcano Engine image generation API (description + style)",
        "Download image and upload to Supabase Storage",
        "Save image record to database",
        "Update scene image_status to 'completed'",
        "Create app/api/generate/images/route.ts",
        "POST /api/generate/images to batch generate all scene images",
        "Iterate through all scenes with description_confirmed=true and image_status=pending",
        "Update project stage to 'images'"
      ],
      "passes": true
    },
    {
      "id": 17,
      "title": "Generation API - Video Generation",
      "description": "Implement video generation and status querying",
      "steps": [
        "Create app/api/generate/video/[sceneId]/route.ts",
        "POST /api/generate/video/:sceneId to create video task for a single scene",
        "Get scene image URL and description",
        "Call Volcano Engine video generation API to create task",
        "Save task_id to database",
        "Update scene video_status to 'processing'",
        "Create app/api/generate/video/[taskId]/route.ts",
        "GET to query video task status",
        "Download video and upload to Storage after task succeeds",
        "Save video record, update video_status to 'completed'",
        "Create app/api/generate/videos/route.ts",
        "POST /api/generate/videos to batch create all scene video tasks",
        "Update project stage to 'videos'"
      ],
      "passes": true
    },
    {
      "id": 18,
      "title": "Confirmation API - Scene and Media Confirmation",
      "description": "Implement user confirmation action APIs",
      "steps": [
        "Create app/api/scenes/[id]/confirm-description/route.ts",
        "POST to confirm a single scene description",
        "Create app/api/scenes/confirm-all-descriptions/route.ts",
        "POST to confirm all scene descriptions",
        "Create app/api/scenes/[id]/confirm-image/route.ts",
        "POST to confirm a single scene image",
        "Create app/api/scenes/confirm-all-images/route.ts",
        "POST to confirm all scene images",
        "Create app/api/scenes/[id]/confirm-video/route.ts",
        "POST to confirm a single scene video",
        "Create app/api/scenes/confirm-all-videos/route.ts",
        "POST to confirm all scene videos, update project stage to 'completed'"
      ],
      "passes": true
    },
    {
      "id": 19,
      "title": "Home Page - UI Implementation",
      "description": "Implement home page interface",
      "steps": [
        "Update app/page.tsx home page",
        "Display welcome message and product introduction",
        "Add 'Create New Project' button",
        "Add 'View My Projects' button",
        "Top navigation bar (login status, user info, logout button)",
        "Create components/layout/Header.tsx navigation bar component"
      ],
      "passes": true
    },
    {
      "id": 20,
      "title": "Project List Page - UI Implementation",
      "description": "Implement project list page",
      "steps": [
        "Create app/projects/page.tsx project list page",
        "Display all user projects (card layout)",
        "Each card shows: title, style, stage, creation date, preview image",
        "Click card to navigate to project details",
        "Add 'Create New Project' button",
        "Support paginated loading"
      ],
      "passes": true
    },
    {
      "id": 21,
      "title": "Create Project Page - UI Implementation",
      "description": "Implement create project page",
      "steps": [
        "Create app/create/page.tsx create project page",
        "Create components/project/CreateProjectForm.tsx form component",
        "Story input field (multiline text)",
        "Style selector (card selection, showing style name and description)",
        "Submit button",
        "Redirect to details page after submission"
      ],
      "passes": true
    },
    {
      "id": 22,
      "title": "Project Detail Page - Base Layout and Stage Indicator",
      "description": "Implement project detail page base layout",
      "steps": [
        "Create app/projects/[id]/page.tsx project detail page",
        "Display project title, story content, style",
        "Create components/project/StageIndicator.tsx stage indicator",
        "Display current stage: draft → scenes → images → videos → completed",
        "Highlight current stage, show checkmark for completed stages",
        "Add link back to project list"
      ],
      "passes": true
    },
    {
      "id": 23,
      "title": "Project Detail Page - Scene Description Stage",
      "description": "Implement scene description display and actions",
      "steps": [
        "Create components/scene/SceneDescriptionCard.tsx scene description card",
        "Display scene number, description content",
        "Support editing description content (can modify LLM-generated content)",
        "Each card displays a 'Confirm' button",
        "Create components/scene/SceneDescriptionList.tsx scene list",
        "Show 'Regenerate Scenes' button at the bottom",
        "Show 'Confirm All Scenes' button at the bottom",
        "Proceed to image generation stage after confirmation"
      ],
      "passes": true
    },
    {
      "id": 24,
      "title": "Project Detail Page - Image Generation Stage",
      "description": "Implement image generation, display and confirmation",
      "steps": [
        "Create components/scene/SceneImageCard.tsx scene image card",
        "Display scene number, description, generated image",
        "Display image generation status (pending/processing/completed/failed)",
        "Each card displays 'Regenerate' and 'Confirm' buttons",
        "Create components/scene/SceneImageList.tsx image list",
        "Show 'Generate All Images' button at the top",
        "Show 'Confirm All Images' button at the bottom",
        "Proceed to video generation stage after confirmation"
      ],
      "passes": true
    },
    {
      "id": 25,
      "title": "Project Detail Page - Video Generation Stage",
      "description": "Implement video generation, display and confirmation",
      "steps": [
        "Create components/scene/SceneVideoCard.tsx scene video card",
        "Display scene number, description, image, generated video",
        "Display video generation status (pending/processing/completed/failed)",
        "Show progress animation during processing status",
        "Each card displays 'Regenerate' and 'Confirm' buttons",
        "Create components/scene/SceneVideoList.tsx video list",
        "Show 'Generate All Videos' button at the top",
        "Show 'Confirm All Videos' button at the bottom",
        "Project complete after confirmation"
      ],
      "passes": true
    },
    {
      "id": 26,
      "title": "Project Detail Page - Completed State",
      "description": "Implement completed project display",
      "steps": [
        "Display video preview for all scenes",
        "Each video can be downloaded individually",
        "Display project completion time",
        "Allow re-entering any stage for modifications"
      ],
      "passes": true
    },
    {
      "id": 27,
      "title": "Project Detail Page - Real-time Status Updates",
      "description": "Implement real-time generation status updates",
      "steps": [
        "Implement polling mechanism to check video generation status",
        "Poll every 5 seconds while video is processing",
        "Automatically update UI when status changes",
        "Display progress bar or loading animation"
      ],
      "passes": true
    },
    {
      "id": 28,
      "title": "Error Handling and Edge Cases",
      "description": "Improve error handling",
      "steps": [
        "Create app/error.tsx global error page",
        "Create app/not-found.tsx 404 page",
        "Create app/projects/[id]/error.tsx project error boundary",
        "API errors return unified format",
        "Frontend displays friendly error messages (Toast component)",
        "Show error info and retry button on generation failure"
      ],
      "passes": true
    },
    {
      "id": 29,
      "title": "Loading States",
      "description": "Add loading state indicators",
      "steps": [
        "Create app/loading.tsx global loading component",
        "Create components/ui/Spinner.tsx loading animation component",
        "Create components/ui/Skeleton.tsx skeleton screen component",
        "Use skeleton screens on list pages",
        "Use loading states on detail pages",
        "Show loading animation during generation"
      ],
      "passes": true
    },
    {
      "id": 30,
      "title": "Responsive Design",
      "description": "Mobile device adaptation",
      "steps": [
        "Navigation bar mobile adaptation (hamburger menu)",
        "Project card responsive layout",
        "Scene card responsive layout",
        "Form responsive layout",
        "Stage indicator responsive layout",
        "Test across different screen sizes"
      ],
      "passes": true
    },
    {
      "id": 31,
      "title": "Final Testing and Optimization",
      "description": "Full workflow testing and optimization",
      "steps": [
        "Run npm run lint to check code standards",
        "Run npm run build to verify successful build",
        "Test full user flow: Register → Login → Create Project → Generate Scenes → Confirm → Generate Images → Confirm → Generate Videos → Confirm → Complete",
        "Test regeneration at each step",
        "Test error handling",
        "Performance optimization (image lazy loading, etc.)"
      ],
      "passes": true
    }
  ]
}
